piranha.comment=new Vue({el:"#comments",data:{loading:!0,contentId:null,items:[],state:"all"},computed:{filteredItems:function(){var t=this;return this.items.filter(function(n){return"all"===t.state||("pending"===t.state?!n.isApproved:n.isApproved)})}},methods:{load:function(t){var n=this;t||(t=""),fetch(piranha.baseUrl+"manager/api/comment/"+t).then(function(t){return t.json()}).then(function(t){n.contentId=t.contentId,n.items=t.comments}).catch(function(t){console.log("error:",t)})},approve:function(t){var n=this;fetch(piranha.baseUrl+"manager/api/comment/approve",{method:"post",headers:piranha.utils.antiForgeryHeaders(),body:JSON.stringify({id:t,parentId:n.contentId})}).then(function(t){return t.json()}).then(function(t){t.status&&piranha.notifications.push(t.status),n.contentId=t.contentId,n.items=t.comments}).catch(function(t){console.log("error:",t)})},unapprove:function(t){var n=this;fetch(piranha.baseUrl+"manager/api/comment/unapprove",{method:"post",headers:piranha.utils.antiForgeryHeaders(),body:JSON.stringify({id:t,parentId:n.contentId})}).then(function(t){return t.json()}).then(function(t){t.status&&piranha.notifications.push(t.status),n.contentId=t.contentId,n.items=t.comments}).catch(function(t){console.log("error:",t)})},toggleApproved:function(t){t.isApproved=!t.isApproved,t.isApproved?this.approve(t.id):this.unapprove(t.id)},remove:function(t){var n=this;fetch(piranha.baseUrl+"manager/api/comment/delete",{method:"delete",headers:piranha.utils.antiForgeryHeaders(),body:JSON.stringify(t)}).then(function(t){return t.json()}).then(function(t){piranha.notifications.push(t),n.load(n.contentId)}).catch(function(t){console.log("error:",t)})},setStatus:function(t){this.state=t}},updated:function(){this.loading=!1}});